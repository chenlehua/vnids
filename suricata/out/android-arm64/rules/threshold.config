# Suricata Threshold Configuration
# VNIDS - Vehicle Network Intrusion Detection System
#
# Copyright (c) 2026 VNIDS Authors
# SPDX-License-Identifier: Apache-2.0

# Rate limiting for flood detection rules
# Limit to 1 alert per 10 seconds per source IP
threshold gen_id 1, sig_id 1000001, type limit, track by_src, count 1, seconds 10
threshold gen_id 1, sig_id 1000002, type limit, track by_src, count 1, seconds 10
threshold gen_id 1, sig_id 1000003, type limit, track by_src, count 1, seconds 10
threshold gen_id 1, sig_id 1000004, type limit, track by_src, count 1, seconds 10

# SOME/IP flood detection thresholds
threshold gen_id 1, sig_id 2000001, type limit, track by_src, count 1, seconds 10
threshold gen_id 1, sig_id 2000002, type limit, track by_src, count 1, seconds 10

# DoIP suspicious activity - limit to prevent alert fatigue
threshold gen_id 1, sig_id 3000001, type limit, track by_src, count 5, seconds 60
threshold gen_id 1, sig_id 3000002, type limit, track by_src, count 5, seconds 60

# Suppress noisy rules during testing (uncomment as needed)
# suppress gen_id 1, sig_id 1000001, track by_src, ip 192.168.1.0/24
